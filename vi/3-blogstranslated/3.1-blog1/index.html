<!doctype html><html lang=vi class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../../images/favicon.png type=image/png><title>Tự động hóa báo cáo kiểm tra AWS Private CA và cảnh báo hết hạn chứng chỉ :: Báo cáo thực tập</title>
<link href=../../../css/nucleus.css?1765476341 rel=stylesheet><link href=../../../css/fontawesome-all.min.css?1765476341 rel=stylesheet><link href=../../../css/hybrid.css?1765476341 rel=stylesheet><link href=../../../css/featherlight.min.css?1765476341 rel=stylesheet><link href=../../../css/perfect-scrollbar.min.css?1765476341 rel=stylesheet><link href=../../../css/auto-complete.css?1765476341 rel=stylesheet><link href=../../../css/atom-one-dark-reasonable.css?1765476341 rel=stylesheet><link href=../../../css/theme.css?1765476341 rel=stylesheet><link href=../../../css/hugo-theme.css?1765476341 rel=stylesheet><link href=../../../css/theme-workshop.css?1765476341 rel=stylesheet><script src=../../../js/jquery-3.3.1.min.js?1765476341></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../../vi/3-blogstranslated/3.1-blog1/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../../js/lunr.min.js?1765476341></script><script type=text/javascript src=../../../js/auto-complete.js?1765476341></script><script type=text/javascript>var baseurl="https://quangbom16.github.io/full-workshop//vi"</script><script type=text/javascript src=../../../js/search.js?1765476341></script></div><div class=highlightable><ul class=topics><li data-nav-id=/vi/1-worklog/ title="Nhật ký công việc" class=dd-item><a href=../../../vi/1-worklog/><b>1. </b>Nhật ký công việc
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/1-worklog/1.1-week1/ title="Worklog Tuần 1" class=dd-item><a href=../../../vi/1-worklog/1.1-week1/><b>1.1. </b>Worklog Tuần 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.2-week2/ title="Báo cáo Tuần 2" class=dd-item><a href=../../../vi/1-worklog/1.2-week2/><b>1.2. </b>Báo cáo Tuần 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.3-week3/ title="Báo cáo Tuần 3" class=dd-item><a href=../../../vi/1-worklog/1.3-week3/><b>1.3. </b>Báo cáo Tuần 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.4-week4/ title="Báo cáo Tuần 4" class=dd-item><a href=../../../vi/1-worklog/1.4-week4/><b>1.4. </b>Báo cáo Tuần 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.5-week5/ title="Báo cáo Tuần 5" class=dd-item><a href=../../../vi/1-worklog/1.5-week5/><b>1.5. </b>Báo cáo Tuần 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.6-week6/ title="Báo cáo Tuần 6" class=dd-item><a href=../../../vi/1-worklog/1.6-week6/><b>1.6. </b>Báo cáo Tuần 6
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.7-week7/ title="Báo cáo Tuần 7" class=dd-item><a href=../../../vi/1-worklog/1.7-week7/><b>1.7. </b>Báo cáo Tuần 7
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.8-week8/ title="Báo cáo Tuần 8" class=dd-item><a href=../../../vi/1-worklog/1.8-week8/><b>1.8. </b>Báo cáo Tuần 8
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.9-week9/ title="Báo cáo Tuần 9" class=dd-item><a href=../../../vi/1-worklog/1.9-week9/><b>1.9. </b>Báo cáo Tuần 9
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.10-week10/ title="Báo cáo Tuần 10" class=dd-item><a href=../../../vi/1-worklog/1.10-week10/><b>1.10. </b>Báo cáo Tuần 10
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.11-week11/ title="Báo cáo Tuần 11" class=dd-item><a href=../../../vi/1-worklog/1.11-week11/><b>1.11. </b>Báo cáo Tuần 11
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/1-worklog/1.12-week12/ title="Báo cáo Tuần 12" class=dd-item><a href=../../../vi/1-worklog/1.12-week12/><b>1.12. </b>Báo cáo Tuần 12
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/2-proposal/ title="Bản đề xuất" class=dd-item><a href=../../../vi/2-proposal/><b>2. </b>Bản đề xuất
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/ title="Các bài blogs đã dịch" class="dd-item
parent"><a href=../../../vi/3-blogstranslated/><b>3. </b>Các bài blogs đã dịch
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/3-blogstranslated/3.1-blog1/ title="Tự động hóa báo cáo kiểm tra AWS Private CA và cảnh báo hết hạn chứng chỉ" class="dd-item
active"><a href=../../../vi/3-blogstranslated/3.1-blog1/><b>3.1. </b>Tự động hóa báo cáo kiểm tra AWS Private CA và cảnh báo hết hạn chứng chỉ
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.2-blog2/ title="Thông báo thế hệ thứ hai của AWS Outposts racks với hiệu suất và khả năng mở rộng đột phá tại cơ sở" class=dd-item><a href=../../../vi/3-blogstranslated/3.2-blog2/><b>3.2. </b>Thông báo thế hệ thứ hai của AWS Outposts racks với hiệu suất và khả năng mở rộng đột phá tại cơ sở
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/3-blogstranslated/3.3-blog3/ title="AWS Lambda chuẩn hóa việc tính phí cho giai đoạn INIT" class=dd-item><a href=../../../vi/3-blogstranslated/3.3-blog3/><b>3.3. </b>AWS Lambda chuẩn hóa việc tính phí cho giai đoạn INIT
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/4-eventparticipated/ title="Các sự kiện đã tham gia" class=dd-item><a href=../../../vi/4-eventparticipated/><b>4. </b>Các sự kiện đã tham gia
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/4-eventparticipated/4.1-event1/ title="Sự kiện: Workshop AI/ML/GenAI trên AWS" class=dd-item><a href=../../../vi/4-eventparticipated/4.1-event1/><b>4.1. </b>Sự kiện: Workshop AI/ML/GenAI trên AWS
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.2-event2/ title="Sự kiện: Workshop DevOps trên AWS" class=dd-item><a href=../../../vi/4-eventparticipated/4.2-event2/><b>4.2. </b>Sự kiện: Workshop DevOps trên AWS
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/4-eventparticipated/4.3-event3/ title="Sự kiện: Workshop AWS Well-Architected Security Pillar" class=dd-item><a href=../../../vi/4-eventparticipated/4.3-event3/><b>4.3. </b>Sự kiện: Workshop AWS Well-Architected Security Pillar
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/ title=Workshop class=dd-item><a href=../../../vi/5-workshop/><b>5. </b>Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.1-workshop-overview/ title="Tổng Quan Workshop" class=dd-item><a href=../../../vi/5-workshop/5.1-workshop-overview/><b>5.1. </b>Tổng Quan Workshop
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.2-prerequiste/ title="Yêu Cầu Tiên Quyết" class=dd-item><a href=../../../vi/5-workshop/5.2-prerequiste/><b>5.2. </b>Yêu Cầu Tiên Quyết
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-infrastructure-setup/ title="Thiết Lập Hạ Tầng" class=dd-item><a href=../../../vi/5-workshop/5.3-infrastructure-setup/><b>5.3 </b>Thiết Lập Hạ Tầng
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/vi/5-workshop/5.3-infrastructure-setup/5.3.1-deploy/ title="Triển khai Hạ tầng" class=dd-item><a href=../../../vi/5-workshop/5.3-infrastructure-setup/5.3.1-deploy/><b>5.3.1. </b>Triển khai Hạ tầng
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-infrastructure-setup/5.3.2-checking/ title="Kiểm tra bằng AWS console" class=dd-item><a href=../../../vi/5-workshop/5.3-infrastructure-setup/5.3.2-checking/><b>5.3.2. </b>Kiểm tra bằng AWS console
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/5-workshop/5.3-infrastructure-setup/5.3.3-application-demonstration/ title="Trình diễn ứng dụng" class=dd-item><a href=../../../vi/5-workshop/5.3-infrastructure-setup/5.3.3-application-demonstration/><b>5.3.3 </b>Trình diễn ứng dụng
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/5-workshop/5.4-clean-up/ title="Dọn dẹp" class=dd-item><a href=../../../vi/5-workshop/5.4-clean-up/><b>5.4. </b>Dọn dẹp
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/vi/6-self-evaluation/ title="Tự đánh giá" class=dd-item><a href=../../../vi/6-self-evaluation/><b>6. </b>Tự đánh giá
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/vi/7-feedback/ title="Chia Sẻ và Phản Hồi" class=dd-item><a href=../../../vi/7-feedback/><b>7. </b>Chia Sẻ và Phản Hồi
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://quangbom16.github.io/full-workshop/3-blogstranslated/3.1-blog1/>English</option><option id=vi value=https://quangbom16.github.io/full-workshop/vi/3-blogstranslated/3.1-blog1/ selected>Tiếng Việt</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../../vi/>Báo cáo thực tập</a> > <a href=../../../vi/3-blogstranslated/>Các bài blogs đã dịch</a> > Tự động hóa báo cáo kiểm tra AWS Private CA và cảnh báo hết hạn chứng chỉ</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#thách-thức-quản-lý-chứng-chỉ-ngoài-các-cài-đặt-mặc-định>Thách thức: Quản lý chứng chỉ ngoài các cài đặt mặc định</a></li><li><a href=#điều-kiện-tiên-quyết>Điều kiện tiên quyết</a></li><li><a href=#tổng-quan-giải-pháp>Tổng quan giải pháp</a></li><li><a href=#triển-khai-giải-pháp>Triển khai giải pháp</a></li><li><a href=#kết-luận>Kết luận</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Tự động hóa báo cáo kiểm tra AWS Private CA và cảnh báo hết hạn chứng chỉ</h1><p><em>Bởi Santosh Vallurupalli và Manthan Raval</em></p><ul><li><p>Bài viết gốc: <a href=https://aws.amazon.com/vi/blogs/security/automating-aws-private-ca-audit-reports-and-certificate-expiration-alerts/ target=_blank rel="noopener noreferrer">Automating AWS Private CA audit reports and certificate expiration alerts – AWS Security Blog</a></p></li><li><p>.docx: <a href="https://docs.google.com/document/d/1sNqRGmA-5V2XF_w0HN3yr571dA4DTM-j_EWXLFpXbFo/edit?usp=sharing" target=_blank rel="noopener noreferrer">GG docs</a></p></li></ul><p>Các tổ chức ngày nay phụ thuộc rất nhiều vào các kênh liên lạc an toàn và đáng tin cậy, và chứng chỉ kỹ thuật số đóng vai trò quan trọng trong việc bảo mật cơ sở hạ tầng nội bộ và bên ngoài bằng cách thiết lập lòng tin và cho phép giao tiếp được mã hóa. Trong khi chứng chỉ công khai thường được sử dụng để bảo mật các ứng dụng internet, nhiều tổ chức lại ưa thích chứng chỉ riêng tư cho các tài nguyên nội bộ để duy trì tính bảo mật và cho phép các cấu hình tùy chỉnh mà chứng chỉ công khai không hỗ trợ.</p><p><strong>AWS Private CA</strong> cung cấp một giải pháp toàn diện để tạo và quản lý hệ thống phân cấp chứng chỉ riêng tư trong cơ sở hạ tầng khóa công khai (PKI) của một tổ chức. AWS xử lý việc quản lý CA nặng nề, cho phép các tổ chức cấp chứng chỉ cho nhiều trường hợp sử dụng khác nhau, bao gồm tạo kênh liên lạc được mã hóa, xác thực máy khách và ký mã bằng mật mã.</p><p>Tuy nhiên, khi các khối lượng công việc phát triển — bao gồm các microservices gốc đám mây, môi trường container hóa và triển khai biên lai lai — các cấu hình chứng chỉ mặc định có thể không đáp ứng mọi nhu cầu. Ví dụ:</p><ul><li>Chứng chỉ TLS riêng tư được yêu cầu bằng <strong>AWS Certificate Manager (ACM)</strong> đi kèm với thời gian hiệu lực cố định là <strong>13 tháng</strong>.</li><li>Các doanh nghiệp hiện đại có thể cần chứng chỉ tồn tại trong thời gian ngắn cho các container tạm thời hoặc chứng chỉ kéo dài cho hệ thống tại chỗ.</li></ul><p>Bạn có thể tạo và cập nhật chứng chỉ thông qua <strong>AWS CLI</strong> hoặc <strong>AWS SDK</strong>. Tuy nhiên, ACM <strong>không tự theo dõi</strong> việc hết hạn của các chứng chỉ được cấp bằng API <code>acm-pca:IssueCertificate</code> và không được yêu cầu bằng ACM. Việc thiếu giám sát này có thể dẫn đến gián đoạn hoạt động.</p><p>Trong bài đăng này, chúng tôi sẽ hướng dẫn bạn quy trình tự động hóa tùy chỉnh tận dụng các báo cáo kiểm tra của AWS Private CA để chủ động giám sát việc hết hạn chứng chỉ bằng cách sử dụng <strong>Amazon EventBridge, AWS Lambda, Amazon S3, Amazon SNS và AWS Security Hub</strong>.</p><h3 id=thách-thức-quản-lý-chứng-chỉ-ngoài-các-cài-đặt-mặc-định>Thách thức: Quản lý chứng chỉ ngoài các cài đặt mặc định</h3><p>Các chứng chỉ được yêu cầu bằng ACM được cấp bởi CA riêng của bạn thông qua console mặc định có thời gian hiệu lực là 13 tháng. ACM theo dõi và tự động gia hạn chúng. Tuy nhiên, môi trường IT hiện đại có các yêu cầu đa dạng:</p><ol><li><strong>Chứng chỉ tồn tại trong thời gian ngắn:</strong> Các môi trường container hóa (EKS, ECS) hoặc Service Mesh (Istio, Linkerd) thường dùng chứng chỉ có hiệu lực vài giờ hoặc vài ngày để giảm bề mặt tấn công.</li><li><strong>Chứng chỉ tồn tại lâu dài:</strong> Các hệ thống tại chỗ (on-premise), IoT hoặc môi trường hạn chế tài nguyên mạng có thể cần chứng chỉ nhiều năm để giảm gánh nặng quản trị.</li></ol><p>Khi sử dụng AWS CLI/SDK để cấp chứng chỉ tùy chỉnh mà không nhập vào ACM, các chứng chỉ này sẽ không được theo dõi, không kích hoạt CloudWatch Logs và không được gia hạn tự động. Nếu không có chế độ xem tập trung, bạn phải tự giám sát ngày hết hạn thủ công.</p><h3 id=điều-kiện-tiên-quyết>Điều kiện tiên quyết</h3><p>Để thực hiện hướng dẫn này, bạn cần có:</p><ul><li>Một tài khoản AWS.</li><li>Một CA riêng từ AWS Private CA.</li><li>Một chứng chỉ được tạo bên ngoài đã được nhập vào ACM (để thử nghiệm).</li></ul><h3 id=tổng-quan-giải-pháp>Tổng quan giải pháp</h3><p>Giải pháp này sử dụng các dịch vụ AWS để giám sát trạng thái chứng chỉ, phát hiện các trường hợp hết hạn sắp tới và thông báo cho quản trị viên, đồng thời tích hợp vào Security Hub.</p><p><strong>Kiến trúc:</strong></p><ol><li><strong>EventBridge Rule (<code>PCAReportRule</code>):</strong> Kích hoạt theo lịch trình (ví dụ: hàng ngày).</li><li><strong>Lambda 1 (<code>PCAauditReportLambdaGenerator</code>):</strong> Gọi API để tạo báo cáo kiểm tra (audit report) và lưu vào S3.</li><li><strong>S3 Bucket:</strong> Lưu trữ báo cáo dưới dạng CSV.</li><li><strong>Lambda 2 (<code>PCAAuditReportLambdaProcessor</code>):</strong> Được kích hoạt bởi sự kiện <code>S3:PutObject</code>. Hàm này tải báo cáo, phân tích và tìm các chứng chỉ sắp hết hạn (ngưỡng mặc định 30 ngày).</li><li><strong>Amazon SNS:</strong> Gửi thông báo email cảnh báo.</li><li><strong>AWS Security Hub:</strong> Tạo các phát hiện (findings) để giám sát tập trung.</li></ol><p><img alt="Hình 1: Kiến trúc giải pháp" src=../../../images/F1.jpeg>
<em>Hình 1: Kiến trúc giải pháp</em></p><h3 id=triển-khai-giải-pháp>Triển khai giải pháp</h3><h4 id=1-triển-khai-mẫu-cloudformation>1. Triển khai mẫu CloudFormation</h4><p>Để bắt đầu, hãy tải xuống mẫu CloudFormation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -O https://aws-security-blog-content.s3.us-east-1.amazonaws.com/public/sample/2526-monitor-private-ca-issued-certificates-aws-private-certificate-authority-eventbridge/ACM-PCA-Monitoring-cfn.yml
</span></span></code></pre></div><p>Mẫu <code>ACM-PCA-Monitoring-cfn.yml</code> bao gồm các tham số tùy chỉnh như <code>CertificateAuthorityArn</code>, <code>S3BucketName</code>, <code>CronJobExpression</code>, <code>SNSName</code>, <code>EmailAddress</code>, và <code>CertificateExpirationThreshold</code>.</p><p>Chạy lệnh sau để tạo stack (thay thế các giá trị trong ngoặc <code>&lt;...></code> bằng thông tin của bạn):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws cloudformation create-stack <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--stack-name PCAMonitoringWorkflow <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--template-body file://ACM-PCA-Monitoring-cfn.yml <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--capabilities CAPABILITY_NAMED_IAM <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--parameters <span style=color:#e6db74>&#39;[
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {&#34;ParameterKey&#34;: &#34;CertificateAuthorityArn&#34;, &#34;ParameterValue&#34;: &#34;&lt;ARN_of_your_PrivateCA&gt;&#34;},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {&#34;ParameterKey&#34;: &#34;S3BucketName&#34;, &#34;ParameterValue&#34;: &#34;&lt;Name_of_s3_bucket&gt;&#34;},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {&#34;ParameterKey&#34;: &#34;EventBridgeRuleName&#34;, &#34;ParameterValue&#34;: &#34;&lt;Name_of_EventBridgeRule&gt;&#34;},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {&#34;ParameterKey&#34;: &#34;CronJobExpression&#34;, &#34;ParameterValue&#34;: &#34;cron(0 21 * * ? *)&#34;},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {&#34;ParameterKey&#34;: &#34;SNSName&#34;, &#34;ParameterValue&#34;: &#34;PCASNSTopic&#34;},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {&#34;ParameterKey&#34;: &#34;SQSName&#34;, &#34;ParameterValue&#34;: &#34;PCASQS&#34;},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {&#34;ParameterKey&#34;: &#34;EmailAddress&#34;, &#34;ParameterValue&#34;: &#34;&lt;Email_to_Receive_alerts&gt;&#34;},
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    {&#34;ParameterKey&#34;: &#34;CertificateExpirationThreshold&#34;, &#34;ParameterValue&#34;: &#34;30&#34;}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>]&#39;</span>
</span></span></code></pre></div><p>Sau khi tạo stack, hãy kiểm tra email để xác nhận đăng ký SNS.</p><p><img alt="Hình 2: Email thông báo mẫu được gửi bởi Amazon SNS" src=../../../images/F2.png>
<em>Hình 2: Email xác nhận đăng ký SNS</em></p><h4 id=2-kiểm-tra-quy-trình-tự-động-hóa>2. Kiểm tra quy trình tự động hóa</h4><p>Tạo một chứng chỉ thử nghiệm có thời hạn ngắn (ví dụ: 20 ngày) để kích hoạt cảnh báo (vì ngưỡng mặc định là 30 ngày).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Generate a Private Key</span>
</span></span><span style=display:flex><span>openssl genrsa -out private-key.pem <span style=color:#ae81ff>2048</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Generate a Certificate Signing Request (CSR)</span>
</span></span><span style=display:flex><span>openssl req -new -key private-key.pem -out csr.pem -subj <span style=color:#e6db74>&#34;/C=US/ST=Ohio/L=Columbus/O=MyOrg/OU=IT/CN=mydomain.com&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Issue a Certificate (valid for 20 days)</span>
</span></span><span style=display:flex><span>aws acm-pca issue-certificate <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--certificate-authority-arn &lt;specify_arn_of_PrivateCA&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--csr <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>cat csr.pem | base64 | tr -d <span style=color:#e6db74>&#39;\n&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--signing-algorithm <span style=color:#e6db74>&#34;SHA256WITHRSA&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--validity Value<span style=color:#f92672>=</span>20,Type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;DAYS&#34;</span>
</span></span></code></pre></div><p>Lưu lại <code>CertificateArn</code> từ kết quả đầu ra, sau đó lấy chứng chỉ về:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aws acm-pca get-certificate <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--certificate-authority-arn &lt;specify_arn_of_PrivateCA&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--certificate-arn &lt;specify_arn_of_Certificate_generated_above&gt; <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--output text &gt; certificate.pem
</span></span></code></pre></div><h4 id=3-chạy-báo-cáo-kiểm-tra-theo-yêu-cầu>3. Chạy báo cáo kiểm tra theo yêu cầu</h4><p>Bạn có thể đợi lịch trình Cron chạy hoặc kích hoạt thủ công để kiểm tra ngay lập tức.</p><p><strong>Cách 1: Chỉnh sửa EventBridge Rule</strong>
Vào console EventBridge -> Rules -> Chọn <code>PCAReportRule</code> -> Edit -> Chuyển lịch trình sang chạy mỗi 30 phút để test -> Sau đó hoàn nguyên lại.</p><p><img alt="Hình 3: Chỉnh sửa lịch trình của PCAReportRule" src=../../../images/F3.png>
<em>Hình 3: Chỉnh sửa lịch trình của PCAReportRule để kiểm tra</em></p><p><strong>Cách 2: Kích hoạt từ Lambda Console</strong>
Vào console Lambda -> Chọn hàm <code>PCAauditReportLambdaGenerator</code> -> Tab <strong>Test</strong> -> Nhấn nút <strong>Test</strong>.</p><p><img alt="Hình 4: Sử dụng console để kích hoạt kiểm tra" src=../../../images/F4.jpeg>
<em>Hình 4: Sử dụng console để kích hoạt kiểm tra</em></p><h4 id=4-xác-minh-kết-quả>4. Xác minh kết quả</h4><p><strong>Kiểm tra S3 Bucket:</strong>
Báo cáo kiểm tra sẽ được tạo trong thư mục <code>audit-report</code> của bucket bạn đã chỉ định.</p><p><img alt="Hình 5: Báo cáo kiểm tra được lưu vào S3" src=../../../images/F5.jpeg>
<em>Hình 5: Báo cáo kiểm tra được lưu vào S3 bucket được chỉ định</em></p><p><strong>Kiểm tra Security Hub:</strong>
Vì chứng chỉ thử nghiệm hết hạn trong 20 ngày (dưới ngưỡng 30 ngày), Security Hub sẽ hiển thị Findings.</p><p><img alt="Hình 6: Xem các phát hiện báo cáo kiểm tra trong Security Hub" src=../../../images/F6.jpeg>
<em>Hình 6: Xem các phát hiện báo cáo kiểm tra trong Security Hub</em></p><p><strong>Kiểm tra Email (SNS):</strong>
Bạn sẽ nhận được email cảnh báo chi tiết về chứng chỉ sắp hết hạn.</p><p><img alt="Hình 7: Email thông báo mẫu" src=../../../images/F7.png>
<em>Hình 7: Email thông báo mẫu được gửi bởi Amazon SNS</em></p><h3 id=kết-luận>Kết luận</h3><p>Giải pháp này biến đổi việc quản lý chứng chỉ truyền thống từ một quy trình thủ công, dễ xảy ra lỗi thành một quy trình tự động. Bằng cách triển khai mẫu CloudFormation này, bạn có thể:</p><ul><li>Tự động hóa việc tạo và xử lý các báo cáo kiểm tra AWS Private CA.</li><li>Nhận thông báo tức thì khi chứng chỉ sắp hết hạn.</li><li>Duy trì khả năng hiển thị tập trung thông qua Security Hub.</li><li>Giảm thiểu rủi ro gián đoạn dịch vụ do chứng chỉ hết hạn.</li></ul><p>Hệ thống có khả năng mở rộng này giúp đơn giản hóa việc quản lý chứng chỉ và tăng cường tư thế bảo mật tổng thể của tổ chức bạn.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../../vi/3-blogstranslated/ title="Các bài blogs đã dịch"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../../vi/3-blogstranslated/3.2-blog2/ title="Thông báo thế hệ thứ hai của AWS Outposts racks với hiệu suất và khả năng mở rộng đột phá tại cơ sở" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../../js/clipboard.min.js?1765476341></script><script src=../../../js/perfect-scrollbar.min.js?1765476341></script><script src=../../../js/perfect-scrollbar.jquery.min.js?1765476341></script><script src=../../../js/jquery.sticky.js?1765476341></script><script src=../../../js/featherlight.min.js?1765476341></script><script src=../../../js/highlight.pack.js?1765476341></script><script>hljs.initHighlightingOnLoad()</script><script src=../../../js/modernizr.custom-3.6.0.js?1765476341></script><script src=../../../js/learn.js?1765476341></script><script src=../../../js/hugo-learn.js?1765476341></script><link href=../../../mermaid/mermaid.css?1765476341 rel=stylesheet><script src=../../../mermaid/mermaid.js?1765476341></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>